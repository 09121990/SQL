-- All RECEIPTDETAIL ,Dr.Name, Matchinh PATIENTS New column to indicate if REGISDATE is in Jan 2025
SELECT  
    RD.MRNO, 
    RD.PATID, 
    RD.BRANCH, 
    RD.RCPTDATE, 
    CP.SNAME, 
    RD.RECAMOUNT,
    PNT.REGISDATE,
    CASE 
        WHEN PNT.REGISDATE BETWEEN TO_DATE('2025-01-01', 'YYYY-MM-DD')  
                               AND TO_DATE('2025-01-31', 'YYYY-MM-DD')  
        THEN 'YES'  
        ELSE 'NO'  
    END AS ">JAN-25"  -- New column to indicate if REGISDATE is in Jan 2025
FROM CLINICPERSONNEL CP
JOIN RECEIPTDETAIL RD 
    ON RD.SID = CP.SID
LEFT JOIN PATIENTS PNT 
    ON RD.PATID = PNT.PATID
WHERE RD.RCPTDATE BETWEEN TO_DATE('2025-01-01', 'YYYY-MM-DD') 
                      AND TO_DATE('2025-01-31', 'YYYY-MM-DD')
ORDER BY RD.MRNO;
----------------------- there are three Table join OPTCHARGEDETAIL , RECEIPTDETAIL, PATIENTS
SELECT DISTINCT  OPT.PATID,OPT.SID,OPT.BILLDATE AS Proc_Bill_Date, 
    'NOT OK' AS RECEIPT_STATUS,
    PNT.REGISDATE  -- Retrieve REGISDATE from PATIENTS table
FROM OPTCHARGEDETAIL OPT
LEFT JOIN PATIENTS PNT 
    ON OPT.PATID = PNT.PATID  -- Joining with PATIENTS table to get REGISDATE
WHERE OPT.BILLDATE BETWEEN TO_DATE('2025-01-01', 'YYYY-MM-DD') 
                      AND TO_DATE('2025-01-31', 'YYYY-MM-DD')
AND NOT EXISTS (
    SELECT 1 FROM RECEIPTDETAIL RD 
    WHERE RD.PATID = OPT.PATID 
    AND RD.RCPTDATE BETWEEN TO_DATE('2025-01-01', 'YYYY-MM-DD') 
                         AND TO_DATE('2025-01-31', 'YYYY-MM-DD')
);
-----------this is another approach by gropu by there are three Table join OPTCHARGEDETAIL , RECEIPTDETAIL, PATIENTS
SELECT OPT.PATID, OPT.SID, OPT.BILLDATE AS Proc_Bill_Date, 
    'NOT OK' AS RECEIPT_STATUS,
    PNT.REGISDATE  -- Retrieve REGISDATE from PATIENTS table
FROM OPTCHARGEDETAIL OPT
LEFT JOIN PATIENTS PNT 
    ON OPT.PATID = PNT.PATID  -- Joining with PATIENTS table to get REGISDATE
WHERE OPT.BILLDATE BETWEEN TO_DATE('2025-01-01', 'YYYY-MM-DD') 
                      AND TO_DATE('2025-01-31', 'YYYY-MM-DD')
AND NOT EXISTS (
    SELECT 1 FROM RECEIPTDETAIL RD 
    WHERE RD.PATID = OPT.PATID 
    AND RD.RCPTDATE BETWEEN TO_DATE('2025-01-01', 'YYYY-MM-DD') 
                         AND TO_DATE('2025-01-31', 'YYYY-MM-DD')
)
GROUP BY OPT.PATID, OPT.SID, OPT.BILLDATE, PNT.REGISDATE ;
